{% extends "base.html" %}

{% block page_content  %}

<form class="form-horizontal" method="post" action="{{url_for('service_provider.Establishment')}}" id="form1" role="form" xmlns:height="http://www.w3.org/1999/xhtml">
                {{ form.csrf_token }}
          <div class="form-group">
            <label for={{form.establishment_name.name}} class="col-sm-2 control-label">{{form.establishment_name.label}}</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" id={{form.establishment_name.name}} name={{form.establishment_name.name}} placeholder="Name of the Establishment" required>
            </div>
          </div>



        <div class="form-group">
            <label class="control-label col-sm-2" for={{form.type.name}}>Establishment Type</label>
            <div class="col-sm-6 col-md-4">

                <select id={{form.type.name}} name="choices_from_form" class="form-control">
                {% for choice in form.type.choices %}
                        <option id={{choice.id}} required>{{choice[loop.index]}}</option>
                {% endfor %}
                </select>
            </div>
        </div>



          <div class="form-group">
            <label for={{form.establishment_description.name}} class="col-sm-2 control-label">{{form.establishment_description.label}}</label>
            <div class="col-sm-10">
              <textarea class="form-control" name={{form.establishment_description.name}} id={{form.establishment_description.name}} placeholder="Description"  rows="5"></textarea>
            </div>
          </div>


        <div class="form-group">
            <label class="control-label col-sm-2" for={{form.type.name}}>Home Delivery Option</label>
            <div class="col-sm-6 col-md-4">
                    <label class="radio-inline">
                        <input type="radio" name="optradio1">Available
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="optradio2">Not Avialable
                    </label>
                    <label class="radio-inline">
                        <input type="radio" name="optradio3">Not Applicable
                    </label>
            </div>
        </div>


        <div class="form-group">
            <label for={{form.proprietor.name}} class="col-sm-2 control-label">{{form.proprietor.label}}</label>
            <div class="col-sm-10">
              <input type="text" name="proprietor" class="form-control" id={{form.proprietor.name}} placeholder="Name of Proprietor">
            </div>
        </div>

        <div class="form-group">
            <label for={{form.phone.name}} class="col-sm-2 control-label">{{form.phone.label}}</label>
            <div class="col-sm-10">
              <input type="tel" name="phone" class="form-control" id={{form.phone.name}} placeholder="Comma seperated list of phone numbers">
            </div>
        </div>



        <div class="form-group">
            <label for={{form.email.name}} class="col-sm-2 control-label">{{form.email.label}}</label>
            <div class="col-sm-10">
              <input type="email" name="email" class="form-control" id={{form.email.name}} placeholder="Comma seperated list of email ids">
            </div>
        </div>


        <div class="form-group">
            <label for={{form.website.name}} class="col-sm-2 control-label">{{form.website.label}}</label>
            <div class="col-sm-10">
              <input type="text" name="website" class="form-control" id={{form.website.name}} placeholder="Website">
            </div>
        </div>


        <div class="form-group">
            <label class="control-label col-sm-2" for={{form.type.name}}>Open days</label>
            <div class="col-md-10">
                    <label class="checkbox-inline no_indent">
                            <input name="open_day_monday" type="checkbox" id="inlineCheckbox1" value="Monday">Monday
                    </label>
                    <label class="checkbox-inline no_indent">
                            <input name="open_day_tuesday" type="checkbox" id="inlineCheckbox2" value="Tuesday">Tuesday
                    </label>
                    <label class="checkbox-inline no_indent">
                            <input name="open_day_wednesday" type="checkbox" id="inlineCheckbox3" value="Wednesday">Wednesday
                    </label>
                    <label class="checkbox-inline no_indent">
                            <input name="open_day_thrusday" type="checkbox" id="inlineCheckbox4" value="Thrusday">Thrusday
                    </label>

                    <label class="checkbox-inline no_indent">
                            <input name="open_day_friday" type="checkbox" id="inlineCheckbox5" value="Friday">Friday
                    </label>
                    <label class="checkbox-inline no_indent">
                            <input name="open_day_saturday" type="checkbox" id="inlineCheckbox6" value="Saturday">Saturday
                    </label>
                    <label class="checkbox-inline no_indent">
                            <input name="open_day_sunday" type="checkbox" id="inlineCheckbox7" value="Sunday">Sunday
                    </label>
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-sm-2">Open Time</label>
            <div class="col-md-4" >
                <p><input name="open_time" size="5px" id="start_time" type="text" class="time" /></p>
            </div>
        </div>

        <!--http://stackoverflow.com/questions/29631402/timepicker-is-not-a-function-when-using-timepicker-js-->
        <div class="form-group">
            <label class="control-label col-sm-2">Close Time</label>
            <div class="col-md-4">
                <input size="5px" name="close_time" id="close_time" type="text" class="time" />
            </div>
        </div>


        <div class="form-group">
            <label for={{form.name_of_shopping_complex.name}} class="col-sm-2 control-label">{{form.name_of_shopping_complex.label}}</label>
            <div class="col-sm-10">
              <input type="text" name="name_of_shopping_complex" class="form-control" id={{form.name_of_shopping_complex.name}} placeholder="Name of Shopping Complex if inside">
            </div>
        </div>







        <div class="form-group">
            <label class="col-sm-2 control-label">Select the Establishment Position on Map</label>
            <div class="col-sm-10" style="height: 750px" id="map_canvas">
            </div>
        </div>




        <div class="form-group">
            <label for={{form.geo_cordinates.name}} class="col-sm-2 control-label">{{form.geo_cordinates.label}}</label>
            <div class="col-sm-10">
              <input type="text" class="form-control" name="geo_cordinates" class="form-control" id={{form.geo_cordinates.name}} placeholder="Geo Cordinates" readonly />
            </div>
        </div>

         <div class="form-group">
            <label for={{form.address.name}} class="col-sm-2 control-label">{{form.address.label}}</label>
            <div class="col-sm-10">
              <input class="form-control" name="address" class="form-control" id={{form.address.name}} placeholder="Complete Address"/>
            </div>
        </div>



        </form>

        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                    <button type="submit" class="btn btn-default" form="form1">Submit</button>
            </div>
        </div>


<!--http://www.a2zwebhelp.com/google-map-drag-marker-get-address-->
 <script>
        var map;
        var marker;
        var myLatlng;
        var geocoder;
        var infowindow;

        function initialize() {
                myLatlng = new google.maps.LatLng("{{latlang[0]}}", "{{latlang[1]}}");
                geocoder = new google.maps.Geocoder();
                infowindow = new google.maps.InfoWindow();
                var myOptions = {
                        zoom: 15,
                        center: myLatlng,
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                }

                var map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);

                var marker = new google.maps.Marker({
                        position: myLatlng,
                        draggable: true,
                        animation: google.maps.Animation.DROP,
                        map: map,
                });

                myListener = google.maps.event.addListener(map, 'click', function(event) {
                        marker.setPosition(event.latLng);
                        marker.setMap(map);
                        geocoder.geocode({'latLng': marker.getPosition()}, function(results, status) {
                                if (status == google.maps.GeocoderStatus.OK) {
                                        if (results[0]) {
                                                $('#address').val(results[0].formatted_address);
                                                $('#geo_cordinates').val(marker.getPosition().lat() + "," + marker.getPosition().lng());
                                                infowindow.setContent(results[0].formatted_address);
                                                infowindow.open(map, marker);
                                        }
                                }
                        });
                });

                geocoder.geocode({'latLng': myLatlng }, function(results, status) {
                        if (status == google.maps.GeocoderStatus.OK) {
                                if (results[0]) {
                                        $('#geo_cordinates').show();
                                        document.getElementById("address").value = results[0].formatted_address;
                                        //$('#address').val(results[0].formatted_address);
                                        $('#geo_cordinates').val(marker.getPosition().lat() + "," + marker.getPosition().lng());

                                        infowindow.setContent(results[0].formatted_address);
                                        infowindow.open(map, marker);
                                }
                        }
                });
                google.maps.event.addListener(marker, 'dragend', function() {
                        geocoder.geocode({'latLng': marker.getPosition()}, function(results, status) {
                                if (status == google.maps.GeocoderStatus.OK) {
                                        if (results[0]) {
                                                $('#address').val(results[0].formatted_address);
                                                $('#geo_cordinates').val(marker.getPosition().lat() + "," + marker.getPosition().lng());
                                                infowindow.setContent(results[0].formatted_address);
                                                infowindow.open(map, marker);
                                        }
                                }
                        });
                });



        }

</script>


 <script>
                $('#start_time').timepicker({'showDuration': true,
                        'timeFormat': 'g:ia'});
                $('#close_time').timepicker({'showDuration': true,
                        'timeFormat': 'g:ia'});
</script>

<script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBzK_c-EFq7J4BkW1_BHNemtZ0SCrvVnOY&callback=initialize">
</script>


{% endblock %}